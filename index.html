<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kyberturvallisuuden itsearviointityökalu</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
    h1 { text-align: center; }
    h2 { margin-top: 30px; color: #003366; }
    h3 { margin-top: 20px; color: #0055a5; }
    .question { margin-bottom: 10px; }
    select, textarea { width: 100%; padding: 5px; margin-top: 5px; }
    .average { font-weight: bold; margin-top: 10px; }
    .report { margin-top: 40px; }
    canvas { max-width: 100%; margin-top: 20px; }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>Kyberturvallisuuden itsearviointityökalu</h1>
<p>
Tämä työkalu auttaa organisaatiotasi arvioimaan kyberturvallisuuden tasoa suhteessa NIS2-direktiivin vaatimuksiin. 
Arviointi kattaa 12 keskeistä aihealuetta, jotka perustuvat Kyberturvallisuuskeskuksen ohjedokumenttiin. 
Jokaisessa aihealueessa on alakohdat, joista kysytään kaksi keskeistä kysymystä. 
Valitse kullekin kysymykselle arvio toteutuksen tasosta (1–4). 
Lisäksi voit kirjata kommentteja ja suosituksia parannustoimista.
</p>

<form id="assessmentForm">

<!-- Aihealueiden generointi -->
<div id="areas"></div>

<button type="button" onclick="calculateResults()">Laske yhteenveto</button>
</form>

<div class="report" id="report">
    <h2>Yhteenvetoraportti</h2>
    <canvas id="averageChart"></canvas>
    <div id="recommendations"></div>
</div>

<script>
const areasData = [
    {
        title: "1. Hallinto ja johtaminen",
        description: "Arvioi organisaation kyberturvallisuuden hallintomallit, vastuut ja johtamisjärjestelmät.",
        subareas: [
            { title: "1.1 Johtamisen sitoutuminen", questions: ["Onko organisaation johto sitoutunut kyberturvallisuuden kehittämiseen?", "Onko kyberturvallisuus integroitu organisaation strategiseen johtamiseen?"] },
            { title: "1.2 Vastuiden ja roolien määrittely", questions: ["Onko kyberturvallisuuteen liittyvät vastuut selkeästi määritelty?", "Onko roolit ja vastuut dokumentoitu ja viestitty henkilöstölle?"] }
        ]
    },
    {
        title: "2. Riskienhallinta",
        description: "Arvioi organisaation kyberturvariskien tunnistamista, arviointia ja hallintaa.",
        subareas: [
            { title: "2.1 Riskien tunnistaminen", questions: ["Onko organisaatiolla prosessi kyberturvariskien tunnistamiseksi?", "Päivitetäänkö riskien tunnistaminen säännöllisesti?"] },
            { title: "2.2 Riskien arviointi", questions: ["Arvioidaanko kyberturvariskien vaikutukset liiketoimintaan?", "Onko riskeille määritelty todennäköisyys ja prioriteetti?"] }
        ]
    },
    {
        title: "3. Turvapolitiikka ja ohjeistukset",
        description: "Arvioi, kuinka hyvin organisaatiolla on dokumentoituja turvallisuuspolitiikkoja ja ohjeistuksia.",
        subareas: [
            { title: "3.1 Turvapolitiikka", questions: ["Onko organisaatiolla kirjallinen kyberturvallisuuspolitiikka?", "Onko politiikka saatavilla koko henkilöstölle?"] },
            { title: "3.2 Ohjeistukset ja standardit", questions: ["Onko organisaatiossa selkeät ohjeistukset turvallisuuden toteuttamiseksi?", "Onko ohjeistukset ajan tasalla ja käytännönläheisiä?"] }
        ]
    },
    // Lisää kaikki 12 aihealuetta samalla tavalla...
];

// Funktio renderöi kaikki alueet
function renderAreas() {
    const container = document.getElementById('areas');
    areasData.forEach((area, areaIndex) => {
        const areaDiv = document.createElement('div');
        areaDiv.innerHTML = `<h2>${area.title}</h2><p>${area.description}</p>`;
        area.subareas.forEach((sub, subIndex) => {
            const subDiv = document.createElement('div');
            subDiv.innerHTML = `<h3>${sub.title}</h3>`;
            sub.questions.forEach((q, qIndex) => {
                const qDiv = document.createElement('div');
                qDiv.classList.add('question');
                qDiv.innerHTML = `
                    <label>${q}</label>
                    <select id="area${areaIndex}_sub${subIndex}_q${qIndex}">
                        <option value="1">1 Ei toteutettu tai ei tietoa</option>
                        <option value="2">2 Osittain toteutettu</option>
                        <option value="3">3 Enimmäkseen toteutettu</option>
                        <option value="4">4 Täysin toteutettu</option>
                    </select>
                    <label>Kommentti:</label>
                    <textarea id="area${areaIndex}_sub${subIndex}_q${qIndex}_comment"></textarea>
                    <label>Suositukset:</label>
                    <textarea id="area${areaIndex}_sub${subIndex}_q${qIndex}_recommendation"></textarea>
                `;
                subDiv.appendChild(qDiv);
            });
        areaDiv.appendChild(subDiv);
        });
        container.appendChild(areaDiv);
    });
}

// Laskee keskiarvot ja generoi raportin
function calculateResults() {
    const averages = [];
    const recommendations = {};
    areasData.forEach((area, areaIndex) => {
        let areaSum = 0;
        let count = 0;
        area.subareas.forEach((sub, subIndex) => {
            sub.questions.forEach((q, qIndex) => {
                const val = parseInt(document.getElementById(`area${areaIndex}_sub${subIndex}_q${qIndex}`).value);
                areaSum += val;
                count++;
                // Kerätään suositukset
                const rec = document.getElementById(`area${areaIndex}_sub${subIndex}_q${qIndex}_recommendation`).value.trim();
                if (rec) {
                    if (!recommendations[area.title]) recommendations[area.title] = [];
                    recommendations[area.title].push(rec);
                }
            });
        });
        const avg = (areaSum / count).toFixed(2);
        averages.push({ title: area.title, average: avg });
        // Näytä keskiarvo alueen alapuolella
        const avgDiv = document.createElement('div');
        avgDiv.className = 'average';
        avgDiv.innerText = `Keskiarvo: ${avg}`;
        document.getElementById('areas').children[areaIndex].appendChild(avgDiv);
    });

    // Piirrä kaavio
    const ctx = document.getElementById('averageChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: averages.map(a => a.title),
            datasets: [{
                label: 'Keskiarvo',
                data: averages.map(a => a.average),
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: { y: { beginAtZero: true, max: 4 } }
        }
    });

    // Näytä suositukset
    const recDiv = document.getElementById('recommendations');
    recDiv.innerHTML = '<h3>Suositukset</h3>';
    for (let area in recommendations) {
        recDiv.innerHTML += `<h4>${area}</h4><ul>`;
        recommendations[area].forEach(r => {
            recDiv.innerHTML += `<li>${r}</li>`;
        });
        recDiv.innerHTML += '</ul>';
    }
}

renderAreas();
</script>

</body>
</html>
